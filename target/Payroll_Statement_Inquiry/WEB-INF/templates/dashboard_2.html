<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Payroll Dashboard</title>
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
  <!-- Include Header Fragment -->
  <div th:replace="~{fragements/header :: header}"></div>

  <div class="container py-4">
    <div class="card shadow-sm">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-striped table-hover mb-0 align-middle">
            <thead class="table-dark">
              <tr>
                <th>#</th>
                <th>Employee ID</th>
                <th>Month</th>
                <th class="text-end">Basic Pay</th>
                <th class="text-end">HRA</th>
                <th class="text-end">Allowances</th>
                <th class="text-end">Deductions</th>
                <th class="text-end">Tax</th>
                <th class="text-end">Lop</th>
                <th class="text-end">Overtime</th>
                 <th class="text-end">Amount</th>
                <th class="text-end">Bonus</th>
                <th class="text-end">Net Pay</th>
                <th>Credited Account</th>
                <th>Credited Date</th>
                <th>Status</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>

            <tbody>
              <!-- ✅ Iterate over list named 'payrolls' -->
              <tr th:each="payroll, iterStat : ${payrolls}">
                <td th:text="${iterStat.count}"></td>
                <td th:text="${payroll.employeeId}"></td>
                <td th:text="${payroll.payrollMonth}"></td>
                <td class="text-end" th:text="${payroll.basicPay}"></td>
                <td class="text-end" th:text="${payroll.hra}"></td>
                <td class="text-end" th:text="${payroll.allowances}"></td>
                <td class="text-end" th:text="${payroll.deductions}"></td>
                <td class="text-end" th:text="${payroll.tax}"></td>
                <td class="text-end" th:text="${payroll.lopDays}"></td>
                <td class="text-end" th:text="${payroll.overtimeHours}"></td>
                <td class="text-end" th:text="${payroll.overtimeAmount}"></td>
                <td class="text-end" th:text="${payroll.bonusAmount}"></td>
                <td class="text-end" th:text="${payroll.netPay}"></td>
                <td class="text-end" th:text="${payroll.creditedAccount}"></td>
                <td class="text-end" th:text="${payroll.creditedDate}"></td>

                <td>
                  <span th:text="${payroll.status}"
                        th:classappend="'badge rounded-pill ' + (${payroll.status} == 'CREDITED' ? 'bg-success' : 'bg-warning text-dark')">
                  </span>
                </td>

                <td class="text-center">
                  <a th:href="@{/payroll/view(id=${payroll.id})}" class="btn btn-sm btn-outline-primary">View</a>
                  <a th:if="${payroll.status != 'CREDITED'}"
                     th:href="@{/payroll/credit/{id}(id=${payroll.id})}"
                     class="btn btn-sm btn-outline-success">Mark Credited</a>
                </td>
              </tr>

              <!-- ✅ Show message when list is empty -->
              <tr th:if="${#lists.isEmpty(payrolls)}">
                <td colspan="16" class="text-center py-4 text-muted">No payroll records found.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div th:replace="~{fragements/footer :: footer}"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
